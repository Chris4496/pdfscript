<!DOCTYPE html>
<html>
  <head>
    <title>Hello, World!</title>
    <!-- Include eel.js - note this file doesn't exist in the 'web' directory -->
    <script type="text/javascript" src="/eel.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css"
    />
  </head>
  <body>
    <!-- Header start -->
    <div class="level">
      <div class="level-left">
        <div class="level-item m-3">
          <button class="button is-link is-small is-light" onclick="goback()">
            Go Back
          </button>
        </div>
      </div>
      <div class="level-right">
        <div class="level-item">
          <h1 class="title m-3">Separate By Students</h1>
        </div>
      </div>
    </div>
    <script>
      eel.expose(goback);
      function goback() {
        window.location = "index.html";
      }
    </script>
    <!-- Header end -->

    <!-- Notification -->
    <div
      class="notification is-danger mx-6"
      style="display: none"
      id="pdf_noti"
    >
      <button
        class="delete"
        onclick="document.querySelector('#pdf_noti').style.display='none'"
      ></button>
      Pick a PDF file!
    </div>
    <div
      class="notification is-danger mx-6"
      style="display: none"
      id="csv_noti"
    >
      <button
        class="delete"
        onclick="document.querySelector('#csv_noti').style.display='none'"
      ></button>
      Pick a CSV file!
    </div>
    <div
      class="notification is-danger mx-6"
      style="display: none"
      id="number_noti"
    >
      <button
        class="delete"
        onclick="document.querySelector('#number_noti').style.display='none'"
      ></button>
      Pick a number!
    </div>
    <script>
      eel.expose(show_noti);
      function show_noti(noti) {
        if (noti == "csv") {
          document.querySelector("#csv_noti").style.display = "block";
        }
        if (noti == "pdf") {
          document.querySelector("#pdf_noti").style.display = "block";
        }
        if (noti == "number") {
          document.querySelector("#number_noti").style.display = "block";
        }
      }
    </script>
    <!-- Notification end -->
    <div class="columns is-multiline is-centered">
      <!-- PDF file upload -->
      <div class="column is-full">
        <div class="file has-name is-centered" id="pdf_select">
          <label class="file-label">
            <input
              class="file-input"
              name="resume"
              type="button"
              onclick="pdfoc()"
            />
            <span class="file-cta">
              <span class="file-label"> Pick a PDF file… </span>
            </span>
            <span class="file-name"> No file picked </span>
          </label>
        </div>
      </div>
      <script>
        async function pdfoc() {
          filename = await eel.get_pdf()();
          if (filename.length > 0) {
            console.log(filename);
            const fileName = document.querySelector("#pdf_select .file-name");
            fileName.textContent = filename;
          }
        }
      </script>
      <!-- PDF file upload end -->
      <!-- PDF pages -->
      <div class="column is-full" id="page_display">
        <h4 class="subtitle is-5 has-text-centered"></h4>
      </div>
      <script>
        eel.expose(show_page_display);
        function show_page_display(pages) {
          document.querySelector(
            "#page_display h4"
          ).textContent = `This file have ${pages} pages`;
        }
      </script>
      <!-- PDF pages end -->

      <!-- Choose csv or input -->
      <div class="column is-full">
        <div class="has-text-centered">
          <button class="button" onclick="show_csv_select()">
            I have a name file(CSV)
          </button>
          <button class="button" onclick="show_student_input()">
            I don't have a name file
          </button>
        </div>
      </div>
      <script>
        function show_csv_select() {
          document.querySelector("#csv_select").style.display = "block";
          document.querySelector("#student_input").style.display = "none";
          document.querySelector("#csv_preview h4").style.display = "block";
          document.querySelector("#csv_submit").style.display = "block";
          document.querySelector("#number_submit").style.display = "none";
        }
        function show_student_input() {
          document.querySelector("#csv_select").style.display = "none";
          document.querySelector("#student_input").style.display = "block";
          document.querySelector("#csv_preview h4").style.display = "none";
          document.querySelector("#csv_submit").style.display = "none";
          document.querySelector("#number_submit").style.display = "block";
        }
      </script>
      <!-- Choose csv or input end -->

      <!-- Student number input -->
      <div class="column is-full" style="display: none" id="student_input">
        <div class="container px-6">
          <input
            id="student_number"
            class="input is-primary"
            type="text"
            placeholder="Number of students"
          />
        </div>
      </div>
      <script>
        eel.expose(get_student_number);
        function get_student_number() {
          return document.querySelector("#student_number").value;
        }
      </script>
      <!-- Student number input end -->

      <!-- CSV file upload -->
      <div class="column is-full" style="display: none" id="csv_select">
        <div class="file has-name is-centered">
          <label class="file-label">
            <input
              class="file-input"
              name="resume"
              type="button"
              onclick="csvoc()"
            />
            <span class="file-cta">
              <span class="file-label"> Pick a CSV file… </span>
            </span>
            <span class="file-name"> No file picked </span>
          </label>
        </div>
      </div>
      <script>
        async function csvoc() {
          filename = await eel.get_csv()();
          if (filename.length > 0) {
            console.log(filename);
            const fileName = document.querySelector("#csv_select .file-name");
            fileName.textContent = filename;
          }
        }
      </script>
      <!-- CSV file upload end -->
      <!-- CSV preview -->
      <div class="column is-full" id="csv_preview">
        <h4
          class="subtitle is-5 has-text-centered"
          style="white-space: pre-line"
        ></h4>
      </div>
      <script>
        eel.expose(show_csv_preview);
        function show_csv_preview(first3names, total) {
          document.querySelector(
            "#csv_preview h4"
          ).textContent = `Names: ${first3names[0]}, ${first3names[1]}, ${first3names[2]}...\n${total} names in total`;
        }
      </script>
      <!-- CSV preview end -->

      <!-- Select save path -->
      <div class="column is-full">
        <div class="file has-name is-centered" id="save_path_select">
          <label class="file-label">
            <input
              class="file-input"
              name="resume"
              type="button"
              onclick="pathoc()"
            />
            <span class="file-cta">
              <span class="file-label"> File save at: </span>
            </span>
            <span class="file-name"> No location picked </span>
          </label>
        </div>
      </div>
      <script>
        eel.expose(pathchange);
        function pathchange(dir) {
          document.querySelector("#save_path_select .file-name").textContent =
            dir;
        }

        async function pathoc() {
          filename = await eel.get_save_path()();
          if (filename.length > 0) {
            console.log(filename);
            const fileName = document.querySelector(
              "#save_path_select .file-name"
            );
            fileName.textContent = filename;
          }
        }
      </script>
      <!-- Select save path end -->

      <!-- csv submit button -->
      <div class="column is-full" id="csv_submit" style="display: none">
        <div class="has-text-centered">
          <button class="button is-success" onclick="eel.submit_SBS('None')">
            Submit
          </button>
        </div>
      </div>
      <!-- csv sumit button end -->
      <!-- student submit button -->
      <div class="column is-full" id="number_submit" style="display: none">
        <div class="has-text-centered">
          <button
            class="button is-success"
            onclick="eel.submit_SBS(get_student_number())"
          >
            Submit
          </button>
        </div>
      </div>
      <!-- student sumit button end -->
    </div>
  </body>
</html>
